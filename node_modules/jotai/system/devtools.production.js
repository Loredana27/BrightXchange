System.register(["react","jotai"],function(G){"use strict";var I,R,T,J,S,L,M,k;return{setters:[function(i){I=i.useContext,R=i.useState,T=i.useEffect,J=i.useDebugValue,S=i.useRef,L=i.useCallback},function(i){M=i.SECRET_INTERNAL_getScopeContext,k=i.useAtom}],execute:function(){G({useAtomDevtools:W,useAtomsDevtools:ee,useAtomsSnapshot:K,useGotoAtomsSnapshot:Q});const i="h",O="n",U="l",x="a",$="m",j=e=>e.debugLabel||e.toString(),q=([e,n])=>Object.fromEntries(n.flatMap(t=>{var s,o;const r=(s=e[$])==null?void 0:s.call(e,t);if(!r)return[];const c=r.t,a=((o=e[x])==null?void 0:o.call(e,t))||{};return[[j(t),{..."e"in a&&{error:a.e},..."p"in a&&{promise:a.p},..."v"in a&&{value:a.v},dependents:Array.from(c).map(j)}]]})),te=G("useAtomsDebugValue",e=>{var n;const t=(n=e==null?void 0:e.enabled)!=null?n:!1,s=M(e==null?void 0:e.scope),{s:o}=I(s),[r,c]=R([]);T(()=>{var a;if(!t)return;const p=()=>{var A;c(Array.from(((A=o[U])==null?void 0:A.call(o))||[]))},m=(a=o[O])==null?void 0:a.call(o,p);return p(),m},[t,o]),J([o,r],q)});function W(e,n,t){(typeof n=="string"||typeof t<"u")&&(console.warn("DEPRECATED [useAtomDevtools] use DevtoolOptions"),n={name:n,scope:t});const{enabled:s,name:o,scope:r}=n||{};let c;try{c=(s!=null?s:!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}const[a,p]=k(e,r),m=S(a),A=S(!1),l=S(),_=o||e.debugLabel||e.toString();T(()=>{if(!c)return;const f=u=>{if(typeof p=="function"){p(u);return}console.warn(`[Warn] you cannot do write operations (Time-travelling, etc) in read-only atoms
`,e)};l.current=c.connect({name:_});const D=l.current.subscribe(u=>{var v,y,d,E,N,g;if(u.type==="ACTION"&&u.payload)try{f(JSON.parse(u.payload))}catch(h){console.error(`please dispatch a serializable value that JSON.parse() support
`,h)}else u.type==="DISPATCH"&&u.state?(((v=u.payload)==null?void 0:v.type)==="JUMP_TO_ACTION"||((y=u.payload)==null?void 0:y.type)==="JUMP_TO_STATE")&&(A.current=!0,f(JSON.parse(u.state))):u.type==="DISPATCH"&&((d=u.payload)==null?void 0:d.type)==="COMMIT"?(E=l.current)==null||E.init(m.current):u.type==="DISPATCH"&&((N=u.payload)==null?void 0:N.type)==="IMPORT_STATE"&&(((g=u.payload.nextLiftedState)==null?void 0:g.computedStates)||[]).forEach(({state:h},P)=>{var b;P===0?(b=l.current)==null||b.init(h):f(h)})});return l.current.shouldInit=!0,D},[e,c,_,p]),T(()=>{!l.current||(m.current=a,l.current.shouldInit?(l.current.init(a),l.current.shouldInit=!1):A.current?A.current=!1:l.current.send(`${_} - ${new Date().toLocaleString()}`,a))},[e,c,_,a])}const F=(e,n)=>{const t=n.map(s=>{var o,r;const c=(r=(o=e[x])==null?void 0:o.call(e,s))!=null?r:{};return[s,"v"in c?c.v:void 0]});return new Map(t)};function K(e){const n=M(e),t=I(n).s;if(!t[O])throw new Error("useAtomsSnapshot can only be used in dev mode.");const[s,o]=R(()=>new Map);return T(()=>{var r;const c=()=>{var p;const m=Array.from(((p=t[U])==null?void 0:p.call(t))||[]);o(F(t,m))},a=(r=t[O])==null?void 0:r.call(t,c);return c(),a},[t]),s}function Q(e){const n=M(e),t=I(n).s;if(!t[O])throw new Error("useGotoAtomsSnapshot can only be used in dev mode.");return L(s=>{t[i](s)},[t])}const Y=(e,n)=>e.size===n.size&&Array.from(e).every(([t,s])=>Object.is(n.get(t),s)),Z=(e,n)=>e.size===n.size&&Array.from(e).every(([t,s])=>{const o=n.get(t);return o&&s.size===o.size&&Array.from(s).every(r=>o.has(r))}),z=e=>e.debugLabel?`${e}:${e.debugLabel}`:`${e}`,H=e=>{const n={};e.values.forEach((s,o)=>{n[z(o)]=s});const t={};return e.dependents.forEach((s,o)=>{t[z(o)]=Array.from(s).map(z)}),{values:n,dependents:t}};function ee(e,n){typeof n<"u"&&typeof n!="object"&&(console.warn("DEPRECATED [useAtomsDevtools] use DevtoolsOptions"),n={scope:n});const{enabled:t,scope:s}=n||{},o=M(s),{s:r,w:c}=I(o);let a;try{a=(t!=null?t:!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(a&&!r[O])throw new Error("useAtomsDevtools can only be used in dev mode.");const[p,m]=R(()=>({values:new Map,dependents:new Map}));T(()=>{var u;if(!a)return;let v=new Map,y=new Map;const d=new Set,E=()=>{var g,h,P;const b=new Map,V=new Map;let X=!1;for(const w of((g=r[U])==null?void 0:g.call(r))||[]){const C=(h=r[x])==null?void 0:h.call(r,w);if(C){if(!C.y){if("p"in C)return;d.has(w)||(d.add(w),X=!0)}"v"in C&&b.set(w,C.v)}const B=(P=r[$])==null?void 0:P.call(r,w);B&&V.set(w,B.t)}X||Y(v,b)&&Z(y,V)||(v=b,y=V,d.clear(),m({values:b,dependents:V}))},N=(u=r[O])==null?void 0:u.call(r,E);return E(),N},[a,r]);const A=L(u=>{const{values:v}=u;c?c(y=>{r[i](v,y)}):r[i](v)},[r,c]),l=S(!1),_=S(!0),f=S(),D=S([]);T(()=>{if(!a)return;const u=(d=D.current.length-1)=>{const E=D.current[d>=0?d:0];if(!E)throw new Error("snaphost index out of bounds");return E},v=a.connect({name:e}),y=v.subscribe(d=>{var E;switch(d.type){case"DISPATCH":switch((E=d.payload)==null?void 0:E.type){case"RESET":break;case"COMMIT":v.init(H(u())),D.current=[];break;case"JUMP_TO_ACTION":case"JUMP_TO_STATE":l.current=!0,A(u(d.payload.actionId-1));break;case"PAUSE_RECORDING":_.current=!_.current;break}}});return f.current=v,f.current.shouldInit=!0,y},[a,A,e]),T(()=>{if(f.current){if(f.current.shouldInit){f.current.init(void 0),f.current.shouldInit=!1;return}l.current?l.current=!1:_.current&&(D.current.push(p),f.current.send({type:`${D.current.length}`,updatedAt:new Date().toLocaleString()},H(p)))}},[p])}}}});
